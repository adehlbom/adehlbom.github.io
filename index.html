<!DOCTYPE html>
<html lang="sv-SE">
  <head>
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-7JHKJS027S"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }

      // Check for Consent
      document.addEventListener("DOMContentLoaded", () => {
        let consent;
        try {
          consent = localStorage.getItem("cookie-consent");
        } catch (e) {
          consent = null;
        }

        if (consent === "accepted") {
          initializeGoogleAnalytics();
        }
      });

      function initializeGoogleAnalytics() {
        gtag("js", new Date());
        gtag("config", "G-7JHKJS027S");
      }
    </script>

    <!-- Metadata for Glitterdalen -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Glitterdalen - En Magisk Värld för Barn och Vuxna</title>
    <meta
      name="description"
      content="Upptäck Glitterdalen – en magisk barnvärld fylld med musik, historier och unika karaktärer. Möt Lumi, Zippy, Illian och Riza – figurer som bjuder på glädje och äventyr!"
    />
    <meta
      name="keywords"
      content="Glitterdalen, fantasi, magi, musik, äventyr, Instagram, YouTube, Spotify, barnberättelser, sånger, äventyrsberättelser"
    />
    <meta name="author" content="Glitterdalen Team" />
    <meta name="robots" content="index, follow" />

    <!-- Open Graph Metadata -->
    <meta property="og:title" content="Glitterdalen - En Magisk Värld" />
    <meta
      property="og:description"
      content="Följ med in i Glitterdalen, en förtrollande plats full av skimrande äventyr och unika berättelser. Se våra videos på YouTube, lyssna på vår musik på Spotify och följ våra glimtar på Instagram!"
    />
    <meta
      property="og:image"
      content="https://www.glitterdalen.se/glitterdalen_logo.png"
    />
    <meta property="og:url" content="https://www.glitterdalen.se" />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="sv-SE" />

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />

    <!-- Preconnect & Load Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Quicksand:wght@400;600&display=swap"
      rel="stylesheet"
    />

    <!-- Länk till extern CSS -->
    <link rel="stylesheet" href="styles.css" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      rel="stylesheet"
    />
    <!-- Meta Pixel Code -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '2354277181586934');
  fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=2354277181586934&ev=PageView&noscript=1"
  /></noscript>
  <!-- End Meta Pixel Code -->
  </head>
  <body>
    <!-- Cookie Banner -->
    <div id="cookie-banner" class="cookie-banner">
      <p>
        Vi använder cookies för att analysera trafik och förbättra din
        upplevelse. Genom att klicka på "Acceptera" godkänner du användningen av
        cookies.
      </p>
      <button id="accept-cookies" class="cookie-btn" autofocus>Acceptera</button>
      <button id="decline-cookies" class="cookie-btn">Avvisa</button>
    </div>

    <div class="landing-container">
      <!-- Logo -->
      <div class="logo-container">
        <img src="glitterdalen_logo.png" alt="Glitterdalen Logo" class="logo" />
      </div>
      <div id="navigation-line">
        <!-- Themed Marker -->
        <!-- <div id="current-location" class="compass"></div> -->

        <!-- Treasure Map Nodes -->
        <div class="node" data-target="valkommen">Välkommen</div>
        <div class="path"></div>
        <div class="node" data-target="signup">Följ oss</div>
        <div class="path"></div>
        <div class="node" data-target="musik">Musik</div>
        <div class="path"></div>
        <div class="node" data-target="karaktarer">Karaktärer</div>
        <div class="path"></div>
        <div class="node" data-target="platser">Platser</div>
      </div>
      <div id="mobile-nav" class="mobile-navigation">
        <div class="nav-item" data-target="valkommen">Välkommen</div>
        <div class="nav-item" data-target="signup">Följ oss</div>
        <div class="nav-item" data-target="musik">Musik</div>
        <div class="nav-item" data-target="karaktarer">Karaktärer</div>
        <div class="nav-item" data-target="platser">Platser</div>
      </div>

      <!-- valkommen Section -->
      <div id="valkommen" class="valkommen section">
        <h2>Välkommen till Glitterdalen!</h2>
        <p>
          Glitterdalen är en magisk värld fylld av musik, lek och fantasi —
          skapad för barn i alla åldrar (och nyfikna vuxna!). <br /><br />
          Möt våra karaktärer: <strong>Lumi</strong> (den
          glittrande kaninen), <strong>Zippy</strong> (den
          uppfinningsrika flugan med astronautdrömmar),
          <strong>Illian</strong> (den envisa illern) och
          <strong>Riza</strong> (den äventyrslystna räven) —
          som tillsammans lockar till skratt, dans och äventyr!
        </p>
        <p>
          Upptäck nya <strong>låtar</strong>, följ
          <strong>spännande berättelser</strong> och låt din fantasi ta fart —
          här i Glitterdalen!
        </p>
      </div>
      <!-- signup Section -->
       <div id="signup" class="signup section">
        <h2>Gå med i Glitterdalen för att få senaste nyheterna och exklusiva erbjudanden – direkt till din inkorg!
        </h2>
        <form
          id="signup-form"
          action="https://assets.mailerlite.com/jsonp/1255993/forms/142396205183272375/subscribe"
          method="post"
        >
          <input
        id="email"
        type="email"
        name="fields[email]"
        placeholder="Skriv in din e-postadress"
        required
          />
          <button type="submit">Anmäl dig nu</button>
        </form>
        <p class="privacy-note">
          <em
        >Vi samlar endast in din e-postadress för att kunna skicka nyheter
        och information om Glitterdalen. Vi delar aldrig din information med
        tredje part. Du kan när som helst avregistrera dig från våra utskick
        via länken i e-postmeddelandet.</em
          >
        </p>
      </div>

      <!-- Success Section (Hidden Initially) -->
      <div id="success" class="section signup hidden">
        <h2>Tack!</h2>
        <p>
          Din e-postadress är nu registrerad för nyheter från Glitterdalen. 
        </p>
      </div>
        <div id="sociala-medier" class="section">
        <h2>Sociala Medier</h2>
        <div class="social-buttons">
          <div class="social-item">
            <a
              class="social-btn"
              href="https://www.instagram.com/glitterdalen/"
              target="_blank"
              aria-label="Instagram"
            >
              <i class="fab fa-instagram"></i>
            </a>
            <p>Instagram</p>
          </div>
          <div class="social-item">
            <a
              class="social-btn"
              href="https://open.spotify.com/artist/35x1x7RZaz5GPlIS4axyCd?si=d26c7821aa654469"
              target="_blank"
              aria-label="Spotify"
            >
              <i class="fab fa-spotify"></i>
            </a>
            <p>Spotify</p>
          </div>
          <div class="social-item">
            <a
              class="social-btn"
              href="https://www.youtube.com/@Glitterdalen"
              target="_blank"
              aria-label="YouTube"
            >
              <i class="fab fa-youtube"></i>
            </a>
            <p>YouTube</p>
          </div>
        </div>
      </div>
    </div>
  </div>
      <!-- musik Section -->
      <div id="musik" class="section">
        <h2>Lyssna på Musiken</h2>
        <div class="iframe-wrapper">
          <iframe
            style="border-radius: 12px"
            src="https://open.spotify.com/embed/artist/35x1x7RZaz5GPlIS4axyCd?utm_source=generator"
            width="100%"
            height="352"
            frameborder="0"
            allowfullscreen=""
            allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
            loading="lazy"
          ></iframe>
        </div>
      </div>

      <!-- karaktarer Section -->
      <div id="karaktarer" class="karaktarer section">
        <h2>Möt Karaktärerna</h2>
        <p>Klicka/håll över varje kort för att få veta mer</p>

        <div class="karaktarer-grid">
          <!-- Lumi Flip Card -->
          <div class="karaktarer-card" onclick="toggleCard(this)">
            <div class="karaktarer-card-inner">
              <!-- Front -->
              <div class="karaktarer-card-front">
                <h3 class="char-name">Lumi</h3>
                <img
                  src="public/lumi.png"
                  alt="Lumi - den glittrande kaninen"
                />
                <div class="tagline">Den glittrande kaninen</div>
              </div>
              <!-- Back -->
              <div class="karaktarer-card-back">
                <p>
                  När Lumi skrattar sprider hon ett magiskt glitter som får hela
                  Glitterdalen att skimra. Hon bor på Vindklippan och håller
                  dalen levande med sin glittrande energi!
                </p>
              </div>
            </div>
          </div>

          <!-- Riza Flip Card -->
          <div class="karaktarer-card" onclick="toggleCard(this)">
            <div class="karaktarer-card-inner">
              <!-- Front -->
              <div class="karaktarer-card-front">
                <h3 class="char-name">Riza</h3>
                <img
                  src="public/riza.png"
                  alt="Riza - Den äventyrslystna räven"
                />
                <div class="tagline">Den äventyrslystna räven</div>
              </div>
              <!-- Back -->
              <div class="karaktarer-card-back">
                <p>
                  Hon älskar att gå på skattjakt och bor i Regnbågsgrottan
                  tillsammans med alla skatter hon samlat. Riza tvekar aldrig
                  när det vankas nya äventyr och mystiska kartor.
                </p>
              </div>
            </div>
          </div>
          <!-- Zippy Flip Card -->
          <div class="karaktarer-card" onclick="toggleCard(this)">
            <div class="karaktarer-card-inner">
              <!-- Front -->
              <div class="karaktarer-card-front">
                <h3 class="char-name">Zippy</h3>
                <img
                  src="public/zippy.png"
                  alt="Zippy - Den uppfinningsrika flugan"
                />
                <div class="tagline">Den uppfinningsrika flugan</div>
              </div>
              <!-- Back -->
              <div class="karaktarer-card-back">
                <p>
                  Eftersom han inte kan flyga på egen hand, bygger han
                  rymdraketer och drömmer om att bli astronaut som Christer
                  Fuglesang. Han bor vid kanten av Molnfloden och hoppas en dag
                  lyfta mot stjärnorna!
                </p>
              </div>
            </div>
          </div>
          <!-- Illian Flip Card -->
          <div class="karaktarer-card" onclick="toggleCard(this)">
            <div class="karaktarer-card-inner">
              <!-- Front -->
              <div class="karaktarer-card-front">
                <h3 class="char-name">Illian</h3>
                <img
                  src="public/illian.png"
                  alt="Illian - Den mystiske enslingen"
                />
                <div class="tagline">Den envisa illern</div>
              </div>
              <!-- Back -->
              <div class="karaktarer-card-back">
                <p>
                  Han är lite missförstådd men trivs bra för sig själv i den
                  tysta skogen. När andra djur kommer dit och väsnas eller
                  sprider glitter blir han sur, men kanske är han inte så avig
                  innerst inne?
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- platser Section -->
      <div id="platser" class="platser section">
        <h2>Besök Platserna</h2>
        <p>Klicka/håll över varje kort för att få veta mer</p>

        <div class="karaktarer-grid">
          <!-- Flugsvampsskogen Flip Card -->
          <div class="karaktarer-card" onclick="toggleCard(this)">
            <div class="karaktarer-card-inner">
              <!-- Front -->
              <div class="karaktarer-card-front">
                <h3 class="char-name">Flugsvampsskogen</h3>
                <img
                  src="/public/flugsvampsskogen.png"
                  alt="Flugsvampsskogen - Den förtrollande skogen"
                />
                <div class="tagline">Den förtrollande skogen</div>
              </div>
              <!-- Back -->
              <div class="karaktarer-card-back">
                <p>
                  En mystisk skog med skimrande svampar som lyser i olika
                  färger. Här slingrar sig stigar till magiska gömställen och
                  spännande äventyr, men skogen kräver respekt och försiktighet.
                </p>
              </div>
            </div>
          </div>

          <!-- Regnbågsgrottan Flip Card -->
          <div class="karaktarer-card" onclick="toggleCard(this)">
            <div class="karaktarer-card-inner">
              <!-- Front -->
              <div class="karaktarer-card-front">
                <h3 class="char-name">Regnbågsgrottan</h3>
                <img
                  src="/public/regnbagsgrottan.png"
                  alt="Regnbågsgrottan - Skattkammaren nära Molnfloden"
                />
                <div class="tagline">Grottan nära Molnfloden</div>
              </div>
              <!-- Back -->
              <div class="karaktarer-card-back">
                <p>
                  Rizas hemliga grotta fylld med hennes fantasirika skatter. Här
                  förvaras allt från skimrande stenar till andra skatter man kan
                  hitta i glitterdalen som en gammal stövel.
                </p>
              </div>
            </div>
          </div>

          <!-- Vindklippan Flip Card -->
          <div class="karaktarer-card" onclick="toggleCard(this)">
            <div class="karaktarer-card-inner">
              <!-- Front -->
              <div class="karaktarer-card-front">
                <h3 class="char-name">Vindklippan</h3>
                <img
                  src="/public/vindklippan.png"
                  alt="Vindklippan - Den majestätiska utsiktsplatsen"
                />
                <div class="tagline">Den majestätiska klippan</div>
              </div>
              <!-- Back -->
              <div class="karaktarer-card-back">
                <p>
                  En vidsträckt klippavsats med utsikt över hela Glitterdalen.
                  Här bor Lumi, och vinden sprider hennes stjärnstoft över hela
                  glitterdalen.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer class="footer">
      <div class="footer-content">
        <a href="#" id="manage-cookies" class="footer-btn">Hantera Cookies</a>
        <strong>//</strong>
        <a href="mailto:info@glitterdalen.se">info@glitterdalen.se</a>
        <p>© 2025 Glitterdalen. Alla rättigheter förbehållna.</p>
      </div>
    </footer>
    <!-- JavaScript -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const cookieBanner = document.getElementById("cookie-banner");
        const consent = localStorage.getItem("cookie-consent");

        if (!consent) {
          cookieBanner.style.display = "block";
        }

        document
          .getElementById("accept-cookies")
          .addEventListener("click", () => {
            localStorage.setItem("cookie-consent", "accepted");
            cookieBanner.style.display = "none";
            initializeGoogleAnalytics();
          });

        document
          .getElementById("decline-cookies")
          .addEventListener("click", () => {
            localStorage.setItem("cookie-consent", "declined");
            cookieBanner.style.display = "none";
          });
      });

      // ------- Form Submit to MailerLite -------
      document
        .getElementById("signup-form")
        .addEventListener("submit", async function (e) {
          e.preventDefault();
          const email = document.getElementById("email").value;

          try {
            const response = await fetch(this.action, {
              method: "POST",
              headers: { "Content-Type": "application/x-www-form-urlencoded" },
              body: new URLSearchParams({
                "fields[email]": email,
                "ml-submit": "1",
              }),
            });

            const result = await response.json();
            if (result.success) {
              document.getElementById("signup").classList.add("hidden");
              document
                .getElementById("success")
                .classList.remove("hidden");
            } else {
              alert("Något gick fel. Försök igen.");
            }
          } catch {
            alert("Något gick fel. Försök igen.");
          }
        });

      // ------- Cookies Banner -------
      document
        .getElementById("manage-cookies")
        .addEventListener("click", () => {
          localStorage.removeItem("cookie-consent");
          document.getElementById("cookie-banner").style.display = "block";
        });

      // ------- Expand/Collapse karaktarer -------
      function toggleExpand(infoId) {
        const infoDiv = document.getElementById(infoId);
        infoDiv.classList.toggle("hidden");
      }
      // ------- Flip Card on Mobile -------
      function toggleCard(card) {
        // Remove active state from all other cards
        document
          .querySelectorAll(".karaktarer-card.active")
          .forEach((activeCard) => {
            if (activeCard !== card) {
              activeCard.classList.remove("active");
            }
          });

        // Toggle active state on the clicked card
        card.classList.toggle("active");
      }

      // Grab nodes, sections, and the current location marker
      const nodes = document.querySelectorAll(".node, .nav-item");
      const sections = document.querySelectorAll(".section");
      const currentLocation = document.getElementById("current-location");
      let isScrollingManually = false; // Flag to track manual scrolling

      // Function to activate a node and move the marker
      const setActiveNode = (targetId) => {
        if (isScrollingManually) return; // Prevent updates during manual scrolling

        nodes.forEach((node) => {
          const isActive = node.dataset.target === targetId;
          node.classList.toggle("active", isActive);

          if (isActive && currentLocation) {
            const nodeRect = node.getBoundingClientRect();
            const navigationRect = document
              .getElementById("navigation-line")
              .getBoundingClientRect();

            // Calculate the new top position for the marker
            const newTop =
              nodeRect.top -
              navigationRect.top +
              nodeRect.height / 2 -
              currentLocation.offsetHeight / 2;

            currentLocation.style.top = `${newTop}px`;
          }
        });
      };

      // Function to update the active section on scroll
      const updateActiveSection = () => {
        if (isScrollingManually) return; // Ignore updates during manual scrolling

        let currentSection = "";

        sections.forEach((section) => {
          const sectionTop = section.offsetTop;
          const sectionHeight = section.offsetHeight;
          const scrollPosition = window.scrollY + window.innerHeight / 3; // Adjusted for better accuracy

          // Check if the scroll position is within the section
          if (
            scrollPosition >= sectionTop - sectionHeight / 4 &&
            scrollPosition < sectionTop + sectionHeight - sectionHeight / 4
          ) {
            currentSection = section.id;
          }
        });

        if (currentSection) {
          setActiveNode(currentSection);
        }
      };

      // Smooth scrolling on node click
      nodes.forEach((node) => {
        node.addEventListener("click", (e) => {
          e.preventDefault(); // Prevent default anchor behavior
          const targetId = node.dataset.target;
          const targetSection = document.getElementById(targetId);

          if (targetSection) {
            isScrollingManually = true; // Set flag to disable scroll event logic
            targetSection.scrollIntoView({
              behavior: "smooth",
              block: "start", // Start aligns with the top of the section
            });

            // Timeout to reset the manual scroll flag
            const scrollDuration = parseFloat(
              getComputedStyle(document.documentElement).scrollBehavior === "smooth"
                ? getComputedStyle(document.documentElement).getPropertyValue("--scroll-duration") || 800
                : 0
            );

            setTimeout(() => {
              isScrollingManually = false; // Reset flag after scroll completes
              setActiveNode(targetId); // Ensure correct active node after scrolling
            }, scrollDuration); // Match this timeout with your scroll animation duration
          }
        });
      });

      // Update active node on scroll
      window.addEventListener("scroll", updateActiveSection);

      // Initial setup on page load
      document.addEventListener("DOMContentLoaded", () => {
        updateActiveSection();
      });

      // Ensure smooth behavior on resize
      window.addEventListener("resize", () => {
        updateActiveSection(); // Recalculate active section on resize
      });
    </script>
  </body>
  
</html>
